DROP TABLE "DBADMIN"."DETALLE_PEDIDO" CASCADE CONSTRAINTS;
DROP TABLE "DBADMIN"."DEVOLUCION" CASCADE CONSTRAINTS;
DROP TABLE "DBADMIN"."EMPLEADO" CASCADE CONSTRAINTS;
DROP TABLE "DBADMIN"."PEDIDO" CASCADE CONSTRAINTS;
DROP TABLE "DBADMIN"."PRODUCTO" CASCADE CONSTRAINTS;
DROP TABLE "DBADMIN"."CLIENTE" CASCADE CONSTRAINTS;
DROP TABLE "DBADMIN"."CATEGORIA" CASCADE CONSTRAINTS;
DROP TABLE "DBADMIN"."ROL" CASCADE CONSTRAINTS;
DROP TABLE "DBADMIN"."SUCURSAL" CASCADE CONSTRAINTS;
DROP TABLE "DBADMIN"."USUARIO" CASCADE CONSTRAINTS;
DROP TABLE "DBADMIN"."VENTA" CASCADE CONSTRAINTS;

CREATE TABLE "DBADMIN"."ACCESORIO" 
(
    "ID_ACCESORIO"NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
    "NOMBRE" VARCHAR2(100),
    "DESCRIPCION" VARCHAR2(500),
    "PRECIO" NUMBER(10,2),
    "STOCK" NUMBER,
    "ID_CATEGORIA" NUMBER
) 
TABLESPACE "LenguajeDB";


-- Table: CATEGORIA
CREATE TABLE "DBADMIN"."CATEGORIA" 
(
    "ID_CATEGORIA" NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
    "NOMBRE" VARCHAR2(100),
    "ACTIVO" NUMBER(1,0),
    "DESCRIPCION" VARCHAR2(500),
    CONSTRAINT "PK_CATEGORIA" PRIMARY KEY ("ID_CATEGORIA")
) 
TABLESPACE "LenguajeDB";

-- Table: CLIENTE
CREATE TABLE "DBADMIN"."CLIENTE" 
(
    "ID_CLIENTE" NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
    "NOMBRE" VARCHAR2(100),
    "APELLIDO" VARCHAR2(100),
    "TELEFONO" VARCHAR2(20),
    "CORREO" VARCHAR2(200),
    "DIRECCION" VARCHAR2(500),
    "ACTIVO" NUMBER(1,0),
    CONSTRAINT "PK_CLIENTE" PRIMARY KEY ("ID_CLIENTE")
) 
TABLESPACE "LenguajeDB";

-- Table: DETALLE_PEDIDO
CREATE TABLE "DBADMIN"."DETALLE_PEDIDO" 
(
    "ID_DETALLE" NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
    "ID_PEDIDO" NUMBER,
    "ID_PRODUCTO" NUMBER,
    "CANTIDAD" NUMBER,
    "PRECIO" NUMBER(10,2),
    "TOTAL" NUMBER(10,2),
    CONSTRAINT "PK_DETALLE_PEDIDO" PRIMARY KEY ("ID_DETALLE")
) 
TABLESPACE "LenguajeDB";

-- Table: DEVOLUCION
CREATE TABLE "DBADMIN"."DEVOLUCION" 
(
    "ID_DEVOLUCION" NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
    "ID_DETALLE" NUMBER,
    "FECHA_DEVOLUCION" DATE,
    "CANTIDAD" NUMBER,
    "MOTIVO" VARCHAR2(500),
    CONSTRAINT "PK_DEVOLUCION" PRIMARY KEY ("ID_DEVOLUCION")
) 
TABLESPACE "LenguajeDB";

-- Table: EMPLEADO
CREATE TABLE "DBADMIN"."EMPLEADO" 
(
    "ID_EMPLEADO" NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
    "NOMBRE" VARCHAR2(100),
    "APELLIDO" VARCHAR2(100),
    "CORREO" VARCHAR2(200),
    "TELEFONO" VARCHAR2(20),
    "ID_SUCURSAL" NUMBER,
    "ACTIVO" NUMBER(1,0),
    "ID_USUARIO" NUMBER,
    CONSTRAINT "PK_EMPLEADO" PRIMARY KEY ("ID_EMPLEADO")
) 
TABLESPACE "LenguajeDB";

-- Table: PEDIDO
CREATE TABLE "DBADMIN"."PEDIDO" 
(
    "ID_PEDIDO" NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
    "ID_CLIENTE" NUMBER,
    "FECHA_PEDIDO" TIMESTAMP,
    "ESTADO" VARCHAR2(20),
    CONSTRAINT "PK_PEDIDO" PRIMARY KEY ("ID_PEDIDO")
) 
TABLESPACE "LenguajeDB";

-- Table: PRODUCTO
CREATE TABLE "DBADMIN"."PRODUCTO" 
(
    "ID_PRODUCTO" NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
    "DESCRIPCION" VARCHAR2(500),
    "PRECIO" NUMBER(10,2),
    "STOCK" NUMBER,
    "RUTA_IMAGEN" VARCHAR2(1024),
    "ID_CATEGORIA" NUMBER,
    "ID_SUCURSAL" NUMBER,
    "ACTIVO" NUMBER(1,0),
    CONSTRAINT "PK_PRODUCTO" PRIMARY KEY ("ID_PRODUCTO")
) 
TABLESPACE "LenguajeDB";

-- Table: ROL
CREATE TABLE "DBADMIN"."ROL" 
(
    "ID_ROL" NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
    "NOMBRE" VARCHAR2(20),
    CONSTRAINT "PK_ROL" PRIMARY KEY ("ID_ROL")
) 
TABLESPACE "LenguajeDB";

-- Table: SUCURSAL
CREATE TABLE "DBADMIN"."SUCURSAL" 
(
    "ID_SUCURSAL" NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
    "NOMBRE" VARCHAR2(100),
    "UBICACION" VARCHAR2(200),
    "TELEFONO" VARCHAR2(20),
    CONSTRAINT "PK_SUCURSAL" PRIMARY KEY ("ID_SUCURSAL")
) 
TABLESPACE "LenguajeDB";

-- Table: USUARIO
CREATE TABLE "DBADMIN"."USUARIO" 
(
    "USERNAME" VARCHAR2(20),
    "PASSWORD" VARCHAR2(512),
    "NOMBRE" VARCHAR2(20),
    "APELLIDO" VARCHAR2(30),
    "CORREO" VARCHAR2(25),
    "TELEFONO" VARCHAR2(15),
    "ACTIVO" NUMBER(1,0),
    "ID_USUARIO" NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
    "ID_ROL" NUMBER,
    CONSTRAINT "PK_USUARIO" PRIMARY KEY ("ID_USUARIO")
) 
TABLESPACE "LenguajeDB";

-- Table: VENTA
CREATE TABLE "DBADMIN"."VENTA" 
(
    "ID_VENTA" NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
    "SUBTOTAL" NUMBER(10,2),
    "IVA" NUMBER(10,2),
    "TOTAL" NUMBER(10,2),
    "ID_CLIENTE" NUMBER,
    "ID_PRODUCTO" NUMBER,
    CONSTRAINT "PK_VENTA" PRIMARY KEY ("ID_VENTA")
) 
TABLESPACE "LenguajeDB";


-- Ref Constraints for Table ACCESORIO
ALTER TABLE "DBADMIN"."ACCESORIO" 
  ADD CONSTRAINT "FK_CATEGORIA_ACCESORIO" 
  FOREIGN KEY ("ID_CATEGORIA") 
  REFERENCES "DBADMIN"."CATEGORIA" ("ID_CATEGORIA") ENABLE;

-- Ref Constraints for Table DETALLE_PEDIDO
ALTER TABLE "DBADMIN"."DETALLE_PEDIDO" 
  ADD FOREIGN KEY ("ID_PEDIDO") 
  REFERENCES "DBADMIN"."PEDIDO" ("ID_PEDIDO") ENABLE;

ALTER TABLE "DBADMIN"."DETALLE_PEDIDO" 
  ADD FOREIGN KEY ("ID_PRODUCTO") 
  REFERENCES "DBADMIN"."PRODUCTO" ("ID_PRODUCTO") ENABLE;

-- Ref Constraints for Table DEVOLUCION
ALTER TABLE "DBADMIN"."DEVOLUCION" 
  ADD FOREIGN KEY ("ID_DETALLE") 
  REFERENCES "DBADMIN"."DETALLE_PEDIDO" ("ID_DETALLE") ENABLE;

-- Ref Constraints for Table EMPLEADO
ALTER TABLE "DBADMIN"."EMPLEADO" 
  ADD CONSTRAINT "FK_EMPLEADO_USUARIO" 
  FOREIGN KEY ("ID_USUARIO") 
  REFERENCES "DBADMIN"."USUARIO" ("ID_USUARIO") ENABLE;

ALTER TABLE "DBADMIN"."EMPLEADO" 
  ADD FOREIGN KEY ("ID_SUCURSAL") 
  REFERENCES "DBADMIN"."SUCURSAL" ("ID_SUCURSAL") ENABLE;

-- Ref Constraints for Table PEDIDO
ALTER TABLE "DBADMIN"."PEDIDO" 
  ADD FOREIGN KEY ("ID_CLIENTE") 
  REFERENCES "DBADMIN"."CLIENTE" ("ID_CLIENTE") ENABLE;

-- Ref Constraints for Table PRODUCTO
ALTER TABLE "DBADMIN"."PRODUCTO" 
  ADD FOREIGN KEY ("ID_CATEGORIA") 
  REFERENCES "DBADMIN"."CATEGORIA" ("ID_CATEGORIA") ENABLE;

ALTER TABLE "DBADMIN"."PRODUCTO" 
  ADD FOREIGN KEY ("ID_SUCURSAL") 
  REFERENCES "DBADMIN"."SUCURSAL" ("ID_SUCURSAL") ENABLE;

-- Ref Constraints for Table USUARIO
ALTER TABLE "DBADMIN"."USUARIO" 
  ADD CONSTRAINT "FK_USUARIO_ROL" 
  FOREIGN KEY ("ID_ROL") 
  REFERENCES "DBADMIN"."ROL" ("ID_ROL") ENABLE;

-- Ref Constraints for Table VENTA
ALTER TABLE "DBADMIN"."VENTA" 
  ADD FOREIGN KEY ("ID_PRODUCTO") 
  REFERENCES "DBADMIN"."PRODUCTO" ("ID_PRODUCTO") ENABLE;

ALTER TABLE "DBADMIN"."VENTA" 
  ADD FOREIGN KEY ("ID_CLIENTE") 
  REFERENCES "DBADMIN"."CLIENTE" ("ID_CLIENTE") ENABLE;


INSERT INTO "DBADMIN"."ROL" ("NOMBRE") VALUES ('cliente');
INSERT INTO "DBADMIN"."ROL" ("NOMBRE") VALUES ('empleado');
INSERT INTO "DBADMIN"."ROL" ("NOMBRE") VALUES ('admin');


INSERT INTO "DBADMIN"."USUARIO" 
(
    "USERNAME", 
    "PASSWORD", 
    "NOMBRE", 
    "APELLIDO", 
    "CORREO", 
    "TELEFONO", 
    "ACTIVO", 
    "ID_ROL"
) 
VALUES 
(
    'Cliente', 
    'Password',
    'Juan', 
    'Pérez', 
    'juan.perez@example.com', 
    '555-1234', 
    1,  -- Activo (1 para sí, 0 para no)
    1   -- ID_ROL para Cliente
);

INSERT INTO "DBADMIN"."USUARIO" 
(
    "USERNAME", 
    "PASSWORD", 
    "NOMBRE", 
    "APELLIDO", 
    "CORREO", 
    "TELEFONO", 
    "ACTIVO", 
    "ID_ROL"
) 
VALUES 
(
    'Empleado', 
    'Password', 
    'María', 
    'Fernández', 
    'maria.fer@example.com', 
    '555-5678', 
    1,  -- Activo (1 para sí, 0 para no)
    2   -- ID_ROL para Empleado
);

INSERT INTO "DBADMIN"."USUARIO" 
(
    "USERNAME", 
    "PASSWORD", 
    "NOMBRE", 
    "APELLIDO", 
    "CORREO", 
    "TELEFONO", 
    "ACTIVO", 
    "ID_ROL"
) 
VALUES 
(
    'Admin', 
    'Password',
    'Pedro', 
    'García', 
    'pedro.garcia@example.com', 
    '555-8765', 
    1,  -- Activo (1 para sí, 0 para no)
    3   -- ID_ROL para Admin
);


-- Table: auditoria usuario	
CREATE TABLE auditoria_usuarios (
    id_auditoria       NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    id_usuario         NUMBER,
    accion             VARCHAR2(50),    
    descripcion        VARCHAR2(255),   
    usuario_accion     VARCHAR2(100),   
    fecha_accion       DATE DEFAULT SYSDATE, 
    detalle_anterior   VARCHAR2(255),  
    detalle_nuevo      VARCHAR2(255)    
);


-- Table: auditoria rol	
CREATE TABLE "DBADMIN"."AUDITORIA_ROL" (
    "ID_AUDITORIA" NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1 CACHE 20 NOORDER NOCYCLE NOKEEP NOSCALE,
    "ID_ROL" NUMBER,
    "NOMBRE" VARCHAR2(20 BYTE),
    "OPERACION" VARCHAR2(10 BYTE),
    "FECHA_OPERACION" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    "USUARIO" VARCHAR2(30 BYTE) DEFAULT USER
) SEGMENT CREATION IMMEDIATE
  PCTFREE 10 PCTUSED 40 INITRANS 1 MAXTRANS 255
  NOCOMPRESS LOGGING
  STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645
  PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1
  BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT)
  TABLESPACE "LenguajeDB";
  
  

  -- Table: auditoria empleado	
CREATE TABLE "DBADMIN"."AUDITORIA_EMPLEADO" (
    "ID_AUDITORIA" NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
    "ID_EMPLEADO" NUMBER,
    "NOMBRE" VARCHAR2(100),
    "APELLIDO" VARCHAR2(100),
    "CORREO" VARCHAR2(200),
    "TELEFONO" VARCHAR2(20),
    "ID_SUCURSAL" NUMBER,
    "ACTIVO" NUMBER(1,0),
    "OPERACION" VARCHAR2(10 BYTE),
    "FECHA_OPERACION" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    "USUARIO" VARCHAR2(30 BYTE) DEFAULT USER
) TABLESPACE "LenguajeDB";

 -- Table: auditoria SUCURSAL	
CREATE TABLE "DBADMIN"."AUDITORIA_SUCURSAL" (
    "ID_AUDITORIA" NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
    "ID_SUCURSAL" NUMBER,
    "NOMBRE" VARCHAR2(100),
    "UBICACION" VARCHAR2(200),
    "TELEFONO" VARCHAR2(20),
    "OPERACION" VARCHAR2(10 BYTE),
    "FECHA_OPERACION" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    "USUARIO" VARCHAR2(30 BYTE) DEFAULT USER
) TABLESPACE "LenguajeDB";
 -- Table: auditoria inicio sesion
CREATE TABLE audit_sesion (
    id_audit NUMBER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    username VARCHAR2(100) NOT NULL,
    operation VARCHAR2(20) NOT NULL,
    timestamp TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    session_id VARCHAR2(50) NOT NULL
);
